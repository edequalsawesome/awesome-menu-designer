import*as e from"@wordpress/interactivity";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const n=(f={getContext:()=>e.getContext,getElement:()=>e.getElement,store:()=>e.store,withScope:()=>e.withScope},g={},t.d(g,f),g),o=300,s=2,i=200,l=400,c=.75,u="rgba(255, 255, 255, 0.75)",a=".wp-block-ollie-mega-menu__menu-container",r=".wp-block-navigation",d=".wp-block-navigation__responsive-container",p=e=>e.querySelector(a),m=(e,t)=>e.classList.contains({custom:"menu-width-custom",content:"menu-width-content",wide:"menu-width-wide",full:"menu-width-full"}[t]);var f,g;let h=null;const{state:M,actions:v}=(0,n.store)("ollie/mega-menu",{state:{get isMenuOpen(){return Object.values(M.menuOpenedBy).filter(Boolean).length>0},get menuOpenedBy(){return(0,n.getContext)().menuOpenedBy},get isDesktop(){return window.innerWidth>=600},hoverTimeout:null,get dynamicHoverDelay(){const e=((0,n.getContext)().topSpacing||0)*s;return o+e}},actions:{closeAllMenus(){v.closeMenu("click"),v.closeMenu("focus"),v.closeMenu("hover")},applyMobileBackgroundColor(e){if(!M.isDesktop&&M.isMenuOpen){const s=(e=>e.closest(d))(e);if(s){const i=(e=>{if(!e||"transparent"===e||"rgba(0, 0, 0, 0)"===e)return null;const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/);if(t){const[,e,n,o,s]=t;return{r:e,g:n,b:o,a:s||1}}return null})(window.getComputedStyle(s).backgroundColor);e.style.backgroundColor=i?(t=i.r,n=i.g,o=i.b,`rgba(${t}, ${n}, ${o}, ${c})`):u}}else e.style.backgroundColor="";var t,n,o},applyTopSpacing(e){const t=e.dataset.topSpacing;t&&parseInt(t)>0&&M.isDesktop?e.style.top=`${t}px`:M.isDesktop||(e.style.top="")},applyMenuWidth(e){if(m(e,"custom")){const t=e.dataset.customWidth;t&&parseInt(t)>0&&(e.style.width=`${t}px`,e.style.maxWidth=`${t}px`)}else(m(e,"content")||m(e,"wide")||m(e,"full"))&&(e.style.width="",e.style.maxWidth="")},determineJustification:(e,t)=>e.classList.contains("menu-justified-center")?"center":e.classList.contains("menu-justified-right")?"right":e.classList.contains("menu-justified-left")?"left":t.classList.contains("items-justified-center")||t.classList.contains("items-justified-space-between")?"center":t.classList.contains("items-justified-right")?"right":"left",getMenuMeasurements(e,t){const n=window.innerWidth;let o=e.offsetWidth;return m(e,"custom")&&e.dataset.customWidth&&(o=parseInt(e.dataset.customWidth)),{windowSpace:n,originalMenuWidth:o,menuRect:e.getBoundingClientRect(),navBlockRect:t.getBoundingClientRect(),leftOffset:t.getBoundingClientRect().left,leftSpace:(n-o)/2}},adjustMegaMenu(){const{ref:e}=(0,n.getElement)(),t=p(e);if(!t)return;const o=(e=>e.closest(r))(t);if(!o)return;v.applyTopSpacing(t),v.applyMobileBackgroundColor(t),v.applyMenuWidth(t);const s=v.determineJustification(t,o),i=v.getMenuMeasurements(t,o);v.applyJustificationPositioning(t,s,i.windowSpace,i.originalMenuWidth,i.menuRect,i.leftOffset,i.leftSpace,i.navBlockRect)},applyJustificationPositioning(e,t,n,o,s){const c=i;if(o>n){const t=Math.max(n,c);e.style.width=`${t}px`,o=t}if(m(e,"wide")||m(e,"full")){if("center"===t){const t=n/2-o/2-s.left,i=parseFloat(e.style.left||0)+t;e.style.left=`${i}px`}}else if("center"===t&&m(e,"custom")&&parseInt(e.dataset.customWidth)&&(e.style.left=`calc( ( -1 * ${o}px / 2 ) + 50% )`),m(e,"content")||m(e,"custom")){const s=e.getBoundingClientRect(),c=s.left,u=s.right;if(c<0||u>n)if("center"===t){let t=0;if(c<0?t=Math.abs(c):u>n&&(t=-(u-n)),m(e,"custom"))e.style.left=`calc( ( -1 * ${o}px / 2 ) + 50% + ${t}px )`;else{const n=parseFloat(e.style.left||window.getComputedStyle(e).left||0);e.style.left=`${n+t}px`}}else{let s=o,a=!1;if(c<0){const e=Math.abs(c);s=Math.min(s,o-e)}if(u>n){const e=u-n;s=Math.min(s,o-e)}if(a=s<l,a&&"true"!==e.dataset.justificationSwapped){const n="left"===t?"right":"left";return e.classList.remove("menu-justified-left","menu-justified-right","menu-justified-center"),e.classList.add(`menu-justified-${n}`),e.dataset.justificationSwapped="true",e.style.width="",e.style.left="",e.style.maxWidth="",v.adjustMegaMenu()}if(!a){const t=Math.max(s,i);e.style.width=`${t}px`}}}},handleResize(){const{ref:e}=(0,n.getElement)(),t=p(e);t&&(v.clearHoverTimeout(),!M.isDesktop&&M.menuOpenedBy.hover&&v.closeMenu("hover"),delete t.dataset.justificationSwapped,v.adjustMegaMenu(),M.isMenuOpen&&v.applyMobileBackgroundColor(t))},toggleMenuOnClick(e){const t=(0,n.getContext)(),{ref:o}=(0,n.getElement)();t.showOnHover&&t.url&&M.isDesktop||(e&&e.preventDefault&&e.preventDefault(),window.document.activeElement!==o&&o.focus(),M.menuOpenedBy.click||M.menuOpenedBy.focus?(v.closeMenu("click"),v.closeMenu("focus")):(t.previousFocus=o,v.openMenu("click")))},closeMenuOnClick(){v.closeMenu("click"),v.closeMenu("focus")},clearHoverTimeout(){M.hoverTimeout&&(clearTimeout(M.hoverTimeout),M.hoverTimeout=null)},setHoverTimeout(e,t){v.clearHoverTimeout(),M.hoverTimeout=setTimeout((0,n.withScope)(e),t)},shouldActivateHover:()=>(0,n.getContext)().showOnHover&&M.isDesktop,handleMouseEnter(){v.shouldActivateHover()&&v.setHoverTimeout((()=>{M.menuOpenedBy.click||(h&&h!==(0,n.getContext)()&&(h.menuOpenedBy.hover=!1),h=(0,n.getContext)(),v.openMenu("hover"))}),o)},handleMouseLeave(){v.shouldActivateHover()&&v.setHoverTimeout((()=>{v.closeMenu("hover")}),M.dynamicHoverDelay)},handleMenuMouseEnter(){v.shouldActivateHover()&&v.clearHoverTimeout()},handleMenuMouseLeave(){v.shouldActivateHover()&&v.setHoverTimeout((()=>{v.closeMenu("hover")}),o)},handleMenuKeydown(e){M.menuOpenedBy.click&&"Escape"===e?.key&&(v.closeMenu("click"),v.closeMenu("focus"))},handleMenuFocusout(e){const t=(0,n.getContext)(),o=t.megaMenu?.querySelector(".wp-block-ollie-mega-menu__menu-container");(null===e.relatedTarget||!o?.contains(e.relatedTarget)&&e.target!==window.document.activeElement)&&v.closeAllMenus()},openMenu(e="click"){M.menuOpenedBy[e]=!0},closeMenu(e="click"){const t=(0,n.getContext)();if(M.menuOpenedBy[e]=!1,!M.isMenuOpen){if(h===t&&(h=null),t.megaMenu?.contains(window.document.activeElement)&&t.previousFocus?.focus(),t.previousFocus=null,t.megaMenu){const e=p(t.megaMenu);e&&delete e.dataset.justificationSwapped}t.megaMenu=null}}},callbacks:{initMenu(){const e=(0,n.getContext)(),{ref:t}=(0,n.getElement)();if(M.isMenuOpen){e.megaMenu=t;const n=p(t);n&&v.applyMobileBackgroundColor(n)}},initMenuLayout(){v.adjustMegaMenu()}}});